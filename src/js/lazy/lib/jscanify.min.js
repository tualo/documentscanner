/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /gh/ColonelParrot/jscanify@master/src/jscanify.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
/*! jscanify v1.2.0 | (c) ColonelParrot and other contributors | MIT License */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.jscanify=t()}(this,(function(){"use strict";return class{constructor(){}findPaperContour(e){const t=new cv.Mat;cv.cvtColor(e,t,cv.COLOR_RGBA2GRAY);const o=new cv.Mat;cv.GaussianBlur(t,o,new cv.Size(5,5),0,0,cv.BORDER_DEFAULT);const r=new cv.Mat;cv.threshold(o,r,0,255,cv.THRESH_BINARY+cv.THRESH_OTSU);let n=new cv.MatVector,c=new cv.Mat;cv.findContours(r,n,c,cv.RETR_CCOMP,cv.CHAIN_APPROX_SIMPLE);let i=0,a=-1;for(let e=0;e<n.size();++e){let t=cv.contourArea(n.get(e));t>i&&(i=t,a=e)}const s=n.get(a);return t.delete(),o.delete(),r.delete(),n.delete(),c.delete(),s}highlightPaper(e,t){(t=t||{}).color=t.color||"orange",t.thickness=t.thickness||10;const o=document.createElement("canvas"),r=o.getContext("2d"),n=cv.imread(e),c=this.findPaperContour(n);if(cv.imshow(o,n),c){const{topLeftCorner:e,topRightCorner:o,bottomLeftCorner:i,bottomRightCorner:a}=this.getCornerPoints(c,n);e&&o&&i&&a&&(r.strokeStyle=t.color,r.lineWidth=t.thickness,r.beginPath(),r.moveTo(...Object.values(e)),r.lineTo(...Object.values(o)),r.lineTo(...Object.values(a)),r.lineTo(...Object.values(i)),r.lineTo(...Object.values(e)),r.stroke())}return n.delete(),o}extractPaper(e,t,o,r){const n=document.createElement("canvas"),c=cv.imread(e),i=this.findPaperContour(c),{topLeftCorner:a,topRightCorner:s,bottomLeftCorner:v,bottomRightCorner:l}=r||this.getCornerPoints(i,c);let d=new cv.Mat,C=new cv.Size(t,o),u=cv.matFromArray(4,1,cv.CV_32FC2,[a.x,a.y,s.x,s.y,v.x,v.y,l.x,l.y]),h=cv.matFromArray(4,1,cv.CV_32FC2,[0,0,t,0,0,o,t,o]),f=cv.getPerspectiveTransform(u,h);return cv.warpPerspective(c,d,f,C,cv.INTER_LINEAR,cv.BORDER_CONSTANT,new cv.Scalar),cv.imshow(n,d),c.delete(),d.delete(),n}getCornerPoints(e){const t=cv.minAreaRect(e).center;let o,r,n,c,i=0,a=0,s=0,v=0;for(let C=0;C<e.data32S.length;C+=2){const u={x:e.data32S[C],y:e.data32S[C+1]},h=(l=u,d=t,Math.hypot(l.x-d.x,l.y-d.y));u.x<t.x&&u.y<t.y?h>i&&(o=u,i=h):u.x>t.x&&u.y<t.y?h>a&&(r=u,a=h):u.x<t.x&&u.y>t.y?h>s&&(n=u,s=h):u.x>t.x&&u.y>t.y&&h>v&&(c=u,v=h)}var l,d;return{topLeftCorner:o,topRightCorner:r,bottomLeftCorner:n,bottomRightCorner:c}}}}));
//# sourceMappingURL=/sm/116e66d3e4a02637ac1858cb8007668f65fe53f1cb4dd1d139f68cb3d90660c8.map
